# DDoS 攻擊檢測系統

基於深度學習的網絡流量 DDoS 攻擊檢測系統，支援多種模型架構，能夠有效識別異常網絡流量。

## 專案簡介

本系統使用最新的深度學習技術，實現了高效準確的 DDoS 攻擊檢測。主要特點：

- 支援多種模型架構：Mamba、CNN-LSTM 等
- 自適應記憶體管理策略
- 完整的性能評估與可視化
- 中文化界面與報告
- 靈活的模型訓練與比較功能

## 最新性能比較結果 (2025-04-17)

### 執行效率比較
- **Mamba 模型**:
  - 訓練時間: 85.62 秒
  - 記憶體使用: 增加 2151.84 MB
  
- **CNN-LSTM 模型**:
  - 訓練時間: 87.25 秒
  - 記憶體使用: 增加 2039.95 MB

### 性能指標比較
| 指標 | Mamba | CNN-LSTM |
|------|--------|----------|
| 準確率 | 98.75% | 98.41% |
| 精確率 | 99.38% | 98.23% |
| 召回率 | 94.39% | 93.67% |
| F1 分數 | 96.82% | 95.90% |
| 誤報率 | 0.15% | 0.42% |

## 系統架構

系統由以下主要模組組成：

- `main.py`：主程序入口，處理命令行參數和工作流程
- `models.py`：深度學習模型定義
- `trainer.py`：模型訓練和評估邏輯
- `data_processor.py`：數據預處理和加載
- `test.py`：模型測試功能
- `plots_generator.py`：視覺化圖表生成

## 記憶體管理策略

系統採用自適應記憶體管理策略，主要特點：

1. **初始化清理**：
   - 訓練開始前執行一次完整的記憶體清理
   - 釋放未使用的 Python 對象和 GPU 緩存

2. **數據順序處理**：
   - 採用順序切割代替隨機採樣
   - 確保數據處理的一致性和可重現性
   - 減少記憶體碎片化

3. **記憶體監控**：
   - 即時追蹤記憶體使用變化
   - 生成詳細的記憶體使用報告和視覺化圖表
   - 自動調整批次大小以優化記憶體使用

## 安裝與環境配置

### 環境需求

本專案使用 Python 環境進行開發，主要依賴項包括：

- **Python 3.8+**：基礎執行環境
- **PyTorch 1.9+**：深度學習框架，用於模型訓練
- **CUDA**：建議使用 GPU 加速訓練過程
- **psutil**：用於系統資源監控
- **其他依賴**：詳見 `requirements.txt`

### 套件說明

專案的所有依賴項都已在 `requirements.txt` 中列出，主要包括：

1. **基礎科學計算**
   - numpy：用於高效的數組操作
   - pandas：用於數據分析和處理

2. **深度學習相關**
   - torch：PyTorch 深度學習框架
   - mambapy：Mamba 模型實現

3. **機器學習工具**
   - scikit-learn：用於數據預處理和評估

4. **資源監控和視覺化**
   - matplotlib：用於生成圖表
   - psutil：用於系統資源監控

### 安裝步驟

1. 創建並激活虛擬環境（建議）：
```bash
python -m venv venv
.\venv\Scripts\activate  # Windows
source venv/bin/activate  # Unix/MacOS
```

2. 安裝依賴：
```bash
pip install -r requirements.txt
```

3. 檢查 CUDA 可用性（可選）：
```bash
python -c "import torch; print(torch.cuda.is_available())"
```

## 使用方法

### 模型比較模式

執行以下命令比較不同模型的性能：

```bash
python main.py --mode compare --max_samples 50000 --epochs 16
```

參數說明：
- `--max_samples`：使用的數據樣本數量
- `--epochs`：訓練輪次數
- `--device`：使用 'cuda' 或 'cpu'（默認自動選擇）

### 單獨訓練模式

訓練特定模型：

```bash
python main.py --mode train --model_type [mamba/cnnlstm] --epochs 16
```

### 測試模式

評估已訓練模型的性能：

```bash
python main.py --mode test --model_path [model_path]
```

## 輸出說明

系統會自動生成以下視覺化結果：

### 1. 性能比較圖表 (performance_comparison.png)
- 展示不同模型的記憶體使用和執行時間對比
- 直觀顯示順序處理模式的效率
- 包含詳細的執行時間分析

### 2. 模型比較圖表 (model_comparison.png)
- 展示模型性能指標對比
- 包括準確率、精確率、召回率等
- 視覺化展示誤報率差異

### 3. 混淆矩陣 (confusion_matrices.png)
- 展示模型預測結果的細節分析
- 幫助理解模型的分類表現

### 4. 訓練歷史 (training_history.png)
- 記錄訓練過程中的各項指標變化
- 顯示損失值和準確率的收斂過程
- 展示記憶體使用的變化趨勢

## 性能優化建議

1. **模型選擇**:
   - 追求高精確率：選用 Mamba 模型（99.38% 精確率）
   - 追求低誤報率：選用 Mamba 模型（0.15% 誤報率）
   - 追求執行效率：兩種模型執行時間相近（85-87秒）

2. **資源使用考量**:
   - Mamba 模型：較高的峰值記憶體（2151.84 MB），執行時間略優
   - CNN-LSTM 模型：較低的記憶體使用（2039.95 MB），執行時間略長

3. **記憶體管理建議**：
   - 使用順序數據切割以提高效率
   - 監控記憶體使用趨勢
   - 根據系統資源調整批次大小

## 維護與支援

如有問題或建議，請提交 Issue 或聯繫開發團隊。

## 版本記錄

### v1.2.1 (2025-04-17)
- 更新為順序數據切割策略
- 優化性能指標計算
- 更新性能比較數據
- 完善文檔說明

### v1.2.0 (2025-04-17)
- 實現自適應記憶體管理策略
- 優化記憶體監控和可視化
- 更新性能比較報告
- 完善文檔說明

### v1.1.0 (2025-04-17)
- 添加記憶體使用監控
- 改進性能比較可視化
- 優化中文介面
- 完善環境配置文檔

### v1.0.0 (2025-04-16)
- 初始版本發布
- 支援 Mamba 和 CNN-LSTM 模型
- 基礎性能評估功能